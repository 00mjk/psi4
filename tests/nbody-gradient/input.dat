#! MP2/aug-cc-pv[DT]Z many body gradient of water trimer (geometry from J. Chem. Theory Comput. 11, 2126-2136 (2015))

comparison_gradient_dict = {} #TEST
comparison_gradient_dict['NoCP'] = [[-0.00161712702117,     0.00397356069284,    -0.00055254625073], #TEST  
                                    [ 0.00504361236582,    -0.00281087422045,     0.00018612794385], #TEST
                                    [-0.00113999754672,    -0.00042223757104,     0.00061503989199], #TEST
                                    [-0.00249581314268,    -0.00365667319165,    -0.00062734153488], #TEST
                                    [ 0.00107540844315,    -0.00078182819800,     0.00059159192876], #TEST
                                    [-0.00029080506265,     0.00615532938631,     0.00024797072985], #TEST
                                    [ 0.00437117853360,    -0.00042281862180,     0.00022013220271], #TEST
                                    [-0.00515699913243,    -0.00322586837606,    -0.00015349914844], #TEST
                                    [ 0.00021054256280,     0.00119141010107,    -0.00052747576328]] #TEST

comparison_gradient_dict['CP']   = [[-0.00087633989228,     0.00443342081554,    -0.00120420872357], #TEST
                                    [ 0.00618554561801,    -0.00230618902343,    -0.00030753305769], #TEST
                                    [-0.00147813149756,    -0.00023542298842,     0.00138412048880], #TEST
                                    [-0.00325105857744,    -0.00319121010068,    -0.00103646384180], #TEST
                                    [ 0.00106449186478,    -0.00118919045395,     0.00135116486997], #TEST
                                    [-0.00132770876894,     0.00689406267624,    -0.00029322747858], #TEST
                                    [ 0.00442504858730,    -0.00137192059462,     0.00098130090385], #TEST
                                    [-0.00525978056145,    -0.00442822419896,     0.00056458337216], #TEST
                                    [ 0.00051793322730,     0.00139467386918,    -0.00143973653348]] #TEST

comparison_gradient_dict['VMFC'] = [[ 0.01028972981503,     0.00106583055394,    -0.00248494818953], #TEST
                                    [-0.00821703469004,     0.00242549506835,     0.00136370328718], #TEST
                                    [ 0.00214631122268,    -0.00133793673263,     0.00108421570324], #TEST
                                    [-0.00632725602720,     0.00893788414141,    -0.00217425583048], #TEST
                                    [ 0.00015949700459,     0.00237190559420,     0.00117561846885], #TEST
                                    [ 0.00225876946984,    -0.00859401644535,     0.00093944710996], #TEST
                                    [-0.00479936097247,    -0.00959103653335,     0.00196679473692], #TEST
                                    [ 0.00638666285679,     0.00586828750375,    -0.00093838542283], #TEST
                                    [-0.00189731867920,    -0.00114641315035,    -0.00093218986344]] #TEST

molecule water_trimer {
O      -2.76373224  -1.24377706  -0.15444566
H      -1.12357791  -2.06227970  -0.05243799
H      -3.80792362  -2.08705525   1.06090407
--
O       2.46924614  -1.75437739  -0.17092884
H       3.76368260  -2.21425403   1.00846104
H       2.30598330   0.07098445  -0.03942473
--
O       0.29127930   3.00875625   0.20308515
H      -1.21253048   1.95820900   0.10303324
H       0.10002049   4.24958115  -1.10222079
units bohr
}

bsse = ['NoCP', 'CP', 'VMFC']
for b in bsse:
    g = gradient('MP2/cc-pV[D,T]Z', molecule=water_trimer, bsse_type=b, max_nbody=2, return_total_data=True)
    compare_arrays(comparison_gradient_dict[b], g, 6, '%s many-body gradient' %b) #TEST
    core.clean()
