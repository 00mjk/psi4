#! wB97X-D test for a large UKS molecule
#! update ref gradient due to new BraggSlater radii

ref = psi4.Matrix.from_list([                         #TEST
         [ 0.000000000000,     0.000000000000,    -0.025427536494], #TEST
         [ 0.000000000000,    -0.000000000000,     0.040024333383], #TEST
         [ 0.000000000000,    -0.000000000000,    -0.000083170800], #TEST
         [-0.012231273168,    -0.000000000000,    -0.007311142976], #TEST
         [ 0.012231273168,     0.000000000000,    -0.007311142976], #TEST
         [-0.000125840149,    -0.001309522212,     0.000025076330], #TEST
         [-0.000125840149,     0.001309522212,     0.000025076330], #TEST
         [ 0.000125840149,     0.001309522212,     0.000025076330], #TEST
         [ 0.000125840149,    -0.001309522212,     0.000025076330]]) #TEST

molecule {
  -1 1
  C         0.00000000     0.00000000     2.13868804
  N         0.00000000     0.00000000     4.42197911
  C         0.00000000     0.00000000    -0.46134192
  C        -1.47758582     0.00000000    -2.82593059
  C         1.47758582     0.00000000    -2.82593059
  H        -2.41269553    -1.74021190    -3.52915989
  H        -2.41269553     1.74021190    -3.52915989
  H         2.41269553     1.74021190    -3.52915989
  H         2.41269553    -1.74021190    -3.52915989
  units bohr
}


set {
    reference             uks
    scf_type              df
    basis                 cc-pvdz
    points 5
    dft_radial_points     160
    dft_spherical_points  590
}


anl_grad = gradient('wB97X-D', dertype=1)
compare_matrices(ref, anl_grad, 6, "Analytic vs Reference wB97X-D Gradients")    #TEST

#fd_grad = gradient('wB97X-D', dertype=1)
#compare_matrices(fd, anl_grad, 4, "Analytic vs FD wB97X-D Gradients")    #TEST
