#! PCM TDSCF Ref. values from lsdaton test case: opa_hf_H2O_noneq_pcmsolver.out
#       Excitation              Transition Dipole Moments               Oscillator
#        Energies            x               y               z           Strengths
#  ===============================================================================
#       0.53739940      0.00000000     -0.00000000     -0.46873812      0.07871662
#       0.62328100     -0.29826571      0.00000000      0.00000000      0.03696573
#       0.62742027     -0.00000000     -0.00000000     -0.00000000      0.00000000
#       0.71034705     -0.00000000     -0.08459875      0.00000000      0.00338928
#       1.01071645     -0.00000000     -0.46594750     -0.00000000      0.14628913
#
# UHF comparison against other implementations:
#CPCM solvation model excitation energies of NH2 radical [eV]:
#(Same radii, epsilon, refraction index, probe radius in each program)
#
#state	PSI4	ORCA	G09
#1	2.43618	2.457	2.4411
#2	7.39834	7.203	7.3993
#3	9.11054	8.991	9.1777
#4	10.1063	9.848	10.1017
#5	10.2178	10.365	10.3305

exc_energies = [
    0.53739940,
    0.62328100,
    0.62742027,
    0.71034705,
    1.01071645,
]

osc_strengths = [
    0.07871662,
    0.03696573,
    0.00000000,
    0.00338928,
    0.14628913,
]

exc_energies_uhf = [
0.08972598844884663,
0.2719972189552112,
0.33525624703045037,
0.3713900898382711,
0.3762084431466903,
]

osc_strengths_uhf = [
0.00414272407997719,
4.590977316768732e-28,
0.005715258102198367,
0.018432750255865125,
0.006434117688452513,
]

ref_scf_energy = -74.069207686891


molecule wat {
unit bohr
  O     0.00000   0.00000   0.00000
  H     0.55168   0.77340   0.00000
  H     0.55168  -0.77340   0.00000
symmetry c1
no_reorient
}

set = {
    scf_type   pk
    basis      3-21G
    e_convergence 8
    pcm true
    maxiter 50
    tdscf_states 5
}

pcm = {
   Units=Angstrom
   Medium {
   SolverType = IEFPCM
   Solvent = Water
   Nonequilibrium = True
   }

   Cavity {
   Type = GePol
   Area = 0.3
   Mode = Implicit
   }
}

r_calc = []
e_calc = []
scf_energy = energy("TD-SCF")
print_variables()
compare_values(ref_scf_energy, scf_energy, 6, "PCM-SCF Energy") #TEST
for i in range(5):
    e_calc.append(variable(f'TD-HF ROOT 0 -> ROOT {i+1} EXCITATION ENERGY - A SYMMETRY'))
    r_calc.append(variable(f'TD-HF ROOT 0 -> ROOT {i+1} OSCILLATOR STRENGTH (LEN) - A SYMMETRY'))
compare_arrays(exc_energies, e_calc, 5, f'PCM EXCITATION ENERGY ') #TEST
compare_arrays(osc_strengths, r_calc, 5, f'PCM OSCILLATOR STRENGTH ') #TEST
