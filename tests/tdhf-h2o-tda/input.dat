from psi4.driver.procrouting.response.scf_response import tdscf_excitations
molecule {
0 1
O
H  1 1.1
H  1 1.1 2 104.0
symmetry c1
}

set {
    basis sto-3g
    scf_type pk
    save_jk True
}

_, wfn = energy('hf', return_wfn=True)

ref_ee = [0.3564617587, 0.4160717386, 0.5056282877, 0.5551918860]
output = tdscf_excitations(wfn, states_per_irrep =[ 4], tda=True)
computed_ee = output[0][0]
for i in range(4):
    compare_values(ref_ee[i], computed_ee[i], 6, "CIS ROOT {} Excitation Energy".format(i+1))
